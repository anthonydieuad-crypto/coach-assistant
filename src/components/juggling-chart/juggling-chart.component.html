<div class="w-full overflow-x-auto bg-black/20 rounded-lg p-2">
  @if (history.length > 0) {
    <svg [attr.viewBox]="'0 0 ' + width + ' ' + height" class="max-w-full h-auto text-gray-300">
      <g [attr.transform]="'translate(' + margin.left + ',' + margin.top + ')'">
        <!-- Axes -->
        <line [attr.x1]="0" [attr.y1]="innerHeight" [attr.x2]="innerWidth" [attr.y2]="innerHeight" stroke="currentColor" stroke-width="1" opacity="0.5"/>
        <line [attr.x1]="0" [attr.y1]="0" [attr.x2]="0" [attr.y2]="innerHeight" stroke="currentColor" stroke-width="1" opacity="0.5"/>

        <!-- Y Axis Ticks -->
        @for (tick of yAxisTicks(); track tick.label) {
          <g [attr.transform]="'translate(0,' + tick.y + ')'">
            <line [attr.x1]="-5" [attr.y1]="0" [attr.x2]="0" [attr.y2]="0" stroke="currentColor" stroke-width="1" opacity="0.5"/>
            <text [attr.x]="-10" dy="0.32em" text-anchor="end" class="text-xs fill-current">{{ tick.label }}</text>
            <line [attr.x1]="0" [attr.y1]="0" [attr.x2]="innerWidth" [attr.y2]="0" stroke="currentColor" stroke-width="0.5" stroke-dasharray="2,2" opacity="0.2"/>
          </g>
        }

        <!-- X Axis Ticks -->
        @for (tick of xAxisTicks(); track tick.x) {
          <g [attr.transform]="'translate(' + tick.x + ',' + innerHeight + ')'">
            <line [attr.x1]="0" [attr.y1]="0" [attr.x2]="0" [attr.y2]="5" stroke="currentColor" stroke-width="1" opacity="0.5"/>
            <text [attr.y]="20" text-anchor="middle" class="text-xs fill-current">{{ tick.label }}</text>
          </g>
        }
        
        <!-- Data Line -->
        @if (linePath()) {
          <path [attr.d]="linePath()" fill="none" stroke="#22d3ee" stroke-width="2"/>
        }

        <!-- Data Points -->
        @for (circle of circles(); track circle.cx + '-' + circle.cy) {
          <g [attr.transform]="'translate(' + circle.cx + ',' + circle.cy + ')'" class="group">
            <circle r="4" fill="#22d3ee" class="transition-transform duration-200 group-hover:scale-125 cursor-pointer"/>
            <text y="-10" text-anchor="middle" class="text-xs fill-current font-bold opacity-0 transition-opacity duration-200 group-hover:opacity-100 pointer-events-none">{{ circle.score }}</text>
          </g>
        }
      </g>
    </svg>
  } @else {
    <div class="flex items-center justify-center h-full bg-black/10 rounded-lg p-8 min-h-[250px]">
        <p class="text-gray-400 italic">Aucun historique de jongles pour afficher le graphique.</p>
    </div>
  }
</div>