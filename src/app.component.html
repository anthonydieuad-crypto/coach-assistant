<div class="min-h-screen flex flex-col">
  <header class="sticky top-0 z-20 bg-slate-900/70 backdrop-blur-lg border-b border-white/10 shadow-lg">
    <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center">
          <svg class="h-8 w-8 text-amber-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12.75 19.5v-5.25m0 5.25H15M12.75 19.5H10.5m4.5-12.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM6 21a2.25 2.25 0 0 1-2.25-2.25V15.75a2.25 2.25 0 0 1 2.25-2.25h12A2.25 2.25 0 0 1 20.25 15.75v3A2.25 2.25 0 0 1 18 21H6Z" />
          </svg>
          <span class="ml-3 text-xl font-bold text-white">Coach Assistant</span>
        </div>
        <div class="flex items-center space-x-1 sm:space-x-2">
          <button (click)="definirVue('liste')" 
                  class="px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  [class.bg-amber-400/20]="vue() === 'liste'"
                  [class.text-amber-300]="vue() === 'liste'"
                  [class.text-gray-300]="vue() !== 'liste'"
                  [class.hover:bg-white/10]="vue() !== 'liste'">
            Équipe
          </button>
          <button (click)="definirVue('presences')" 
                  class="px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  [class.bg-amber-400/20]="vue() === 'presences'"
                  [class.text-amber-300]="vue() === 'presences'"
                  [class.text-gray-300]="vue() !== 'presences'"
                  [class.hover:bg-white/10]="vue() !== 'presences'">
            Présences
          </button>
           <button (click)="definirVue('bilan-presences')" 
                  class="px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  [class.bg-amber-400/20]="vue() === 'bilan-presences'"
                  [class.text-amber-300]="vue() === 'bilan-presences'"
                  [class.text-gray-300]="vue() !== 'bilan-presences'"
                  [class.hover:bg-white/10]="vue() !== 'bilan-presences'">
            Bilan Présences
          </button>
          <button (click)="definirVue('bilan-competitions')" 
                  class="px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  [class.bg-amber-400/20]="vue() === 'bilan-competitions'"
                  [class.text-amber-300]="vue() === 'bilan-competitions'"
                  [class.text-gray-300]="vue() !== 'bilan-competitions'"
                  [class.hover:bg-white/10]="vue() !== 'bilan-competitions'">
            Bilan Compétitions
          </button>
          <button (click)="definirVue('calendrier')" 
                  class="px-3 py-2 rounded-md text-sm font-medium transition-colors"
                  [class.bg-amber-400/20]="vue() === 'calendrier'"
                  [class.text-amber-300]="vue() === 'calendrier'"
                  [class.text-gray-300]="vue() !== 'calendrier'"
                  [class.hover:bg-white/10]="vue() !== 'calendrier'">
            Calendrier
          </button>
        </div>
      </div>
    </nav>
  </header>

  <main class="flex-grow container mx-auto px-4 sm:px-6 lg:px-8">
    @switch (vue()) {
      @case ('liste') {
        <app-liste-joueurs 
          [joueurs]="joueurs()" 
          [evenements]="evenements()"
          (voirJoueur)="gererVoirJoueur($event)"
          (ajouterJoueur)="gererDemandeAjoutJoueur()"
          (supprimerJoueur)="gererSupprimerJoueur($event)">
        </app-liste-joueurs>
      }
      @case ('detail') {
        @if (joueurPourDetail(); as joueur) {
          <app-detail-joueur 
            [joueur]="joueur" 
            (retourListe)="gererRetourListe()"
            (supprimerJoueur)="gererSupprimerJoueur($event)">
          </app-detail-joueur>
        } @else {
          <p class="text-center text-red-500 p-8">Erreur: Joueur non trouvé.</p>
        }
      }
      @case ('presences') {
        <app-suivi-presences [joueurs]="joueurs()"></app-suivi-presences>
      }
      @case ('bilan-presences') {
        <app-bilan-presences [joueurs]="joueurs()"></app-bilan-presences>
      }
      @case ('bilan-competitions') {
        <app-bilan-competitions [joueurs]="joueurs()"></app-bilan-competitions>
      }
      @case ('calendrier') {
        <app-calendrier></app-calendrier>
      }
    }
  </main>
</div>

<!-- Modale d'ajout de joueur -->
@if (estModaleAjoutJoueurOuverte()) {
  <div class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4" (click)="fermerModaleAjoutJoueur()">
    <div class="bg-slate-800/70 backdrop-blur-lg border border-white/20 rounded-lg shadow-2xl p-6 w-full max-w-lg animate-fade-in" (click)="$event.stopPropagation()">
      <h3 class="text-xl font-bold text-white mb-4">Ajouter un nouveau joueur</h3>
      <form (submit)="$event.preventDefault(); enregistrerNouveauJoueur()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="prenom" class="block text-sm font-medium text-gray-300">Prénom</label>
            <input type="text" id="prenom" [value]="nouveauJoueur().prenom" (input)="gererSaisieNouveauJoueur('prenom', $event)" class="mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-500 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500" required>
          </div>
          <div>
            <label for="nom" class="block text-sm font-medium text-gray-300">Nom</label>
            <input type="text" id="nom" [value]="nouveauJoueur().nom" (input)="gererSaisieNouveauJoueur('nom', $event)" class="mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-500 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500" required>
          </div>
          <div class="md:col-span-2">
            <label for="nomParent" class="block text-sm font-medium text-gray-300">Nom du Parent</label>
            <input type="text" id="nomParent" [value]="nouveauJoueur().nomParent" (input)="gererSaisieNouveauJoueur('nomParent', $event)" class="mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-500 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500" required>
          </div>
          <div>
            <label for="telParent" class="block text-sm font-medium text-gray-300">Téléphone Parent</label>
            <input type="tel" id="telParent" [value]="nouveauJoueur().telParent" (input)="gererSaisieNouveauJoueur('telParent', $event)" class="mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-500 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500" required>
          </div>
           <div>
            <label for="emailParent" class="block text-sm font-medium text-gray-300">Email Parent</label>
            <input type="email" id="emailParent" [value]="nouveauJoueur().emailParent" (input)="gererSaisieNouveauJoueur('emailParent', $event)" class="mt-1 block w-full px-3 py-2 bg-slate-900/50 border border-slate-500 rounded-md shadow-sm focus:outline-none focus:ring-amber-500 focus:border-amber-500" required>
          </div>
        </div>
        <div class="mt-6 flex justify-end space-x-3">
          <button type="button" (click)="fermerModaleAjoutJoueur()" class="px-4 py-2 bg-slate-600 text-gray-200 font-semibold rounded-lg hover:bg-slate-500">
            Annuler
          </button>
          <button type="submit" [disabled]="!nouveauJoueur().prenom || !nouveauJoueur().nom" class="px-4 py-2 bg-amber-600 text-white font-semibold rounded-lg shadow-md hover:bg-amber-700 disabled:bg-gray-500 disabled:cursor-not-allowed">
            Enregistrer
          </button>
        </div>
      </form>
    </div>
  </div>
}
